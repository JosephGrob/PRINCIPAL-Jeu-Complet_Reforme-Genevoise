# Jeu interactif sur la R√©forme protestante genevoise (XVI√®me si√®cle)

## Introduction

Le projet **Jeu interactif sur la R√©forme genevoise au XVI√®me si√®cle** est une exp√©rience √©ducative num√©rique qui invite les utilisateurs √† explorer l'histoire et les lieux de la R√©forme protestante √† Gen√®ve √† travers une s√©rie de mini-jeux interactifs. Ces jeux sont int√©gr√©s dans une carte interactive qui sert de point de d√©part pour d√©couvrir divers aspects culturels, religieux et historiques li√©s √† la R√©forme.

Ce jeu est con√ßu pour √™tre inclus dans une **borne tactile ou sur des tablettes disponibles au public dans un mus√©e** consacr√© √† la R√©forme protestante √† Gen√®ve. L'objectif est de fournir un moyen ludique et immersif de d√©couvrir ou d'approfondir les connaissances sur cette p√©riode cl√© de l'histoire genevoise. 

Nous partons de l'id√©e que les utilisateurs auront d√©j√† acquis quelques connaissances contextuelles gr√¢ce √† l'exposition principale du mus√©e. Ainsi, le jeu sert √† deux objectifs principaux :
- Pour les visiteurs curieux ou r√©fractaires aux approches traditionnelles du mus√©e, le jeu constitue un **point d'entr√©e ludique** pour d√©couvrir la R√©forme.
- Pour les visiteurs d√©sireux d'en apprendre davantage, il agit comme un **outil d'approfondissement**, mettant en lumi√®re des aspects compl√©mentaires de l'exposition.

Gr√¢ce √† sa conception interactive et p√©dagogique, le jeu s'int√®gre harmonieusement dans l'exp√©rience mus√©ale et offre une alternative engageante √† l'apprentissage passif, tout en restant fid√®le au contenu historique du mus√©e.

---

## Objectifs et Public Cible

### Objectifs
- **Sensibilisation historique :** Faire d√©couvrir l‚Äôhistoire de la R√©forme protestante √† Gen√®ve au XVI√®me et son impact culturel et religieux.
- **Engagement par le jeu :** Rendre l'apprentissage captivant et ludique gr√¢ce √† des mini-jeux vari√©s. Tous les mini-jeux sont interconnect√©s : chaque victoire dans un mini-jeu permet √† l'utilisateur de gagner une **lettre**. Ces lettres, une fois r√©unies, composent l'adresse d'un **lieu secret** √† d√©couvrir. Cette m√©canique de r√©compense maintient la motivation de l'utilisateur, l'incitant √† explorer tous les mini-jeux lui permettant ainsi d'acqu√©rir les connaissances n√©cessaires sur cet √©v√©nement historique.
- **Apprentissage interactif :** Offrir une alternative aux supports traditionnels des mus√©es, adapt√©e √† un public recherchant une exp√©rience plus dynamique.
- **Approfondissement des connaissances :** Permettre aux utilisateurs ayant d√©j√† quelques notions sur la R√©forme, acquises gr√¢ce √† l‚Äôexposition du mus√©e, d'approfondir leur compr√©hension √† travers des jeux contextuels.

### Public cible

Le jeu est con√ßu pour √™tre inclus dans le contexte d'un mus√©e d√©di√© √† la R√©forme protestante √† Gen√®ve, et s'adresse √† un public diversifi√©, comprenant :

- **Tous les √¢ges :** Que ce soit des enfants, des adolescents, des adultes ou des seniors, chacun peut participer gr√¢ce √† des mini-jeux adapt√©s √† diff√©rents niveaux de complexit√©.
- **Tous les niveaux de connaissances :** 
  - **D√©butants :** Les visiteurs peu familiers avec la R√©forme peuvent explorer et apprendre les bases historiques et culturelles de mani√®re ludique.
  - **Interm√©diaires :** Ceux ayant d√©j√† des notions g√©n√©rales sur la R√©forme, souvent acquises lors de leur visite au mus√©e, peuvent approfondir leurs connaissances gr√¢ce aux jeux interactifs.
  - **Experts :** Les amateurs d‚Äôhistoire ou les visiteurs aguerris peuvent tester leurs connaissances en explorant des aspects moins connus ou anecdotiques.
- **Groupes scolaires et familles :** Le jeu constitue une activit√© √©ducative et collaborative id√©ale √† faire en groupe, permettant aux groupes de visiteurs de partager une exp√©rience immersive tout en d√©couvrant l‚Äôhistoire de la R√©forme.

En tant qu‚Äôoutil num√©rique int√©gr√© √† des bornes tactiles ou √† des tablettes disponibles dans le mus√©e, ce jeu s'adapte parfaitement √† un large √©ventail de visiteurs, rendant l'exposition plus dynamique et interactive.


---

## Construction et organisation du jeu r√©pondant aux objectifs et aux publics cibles

Le jeu est structur√© en plusieurs mini-jeux, chacun expliqu√© dans des fichiers .md distincts. Cette organisation facilite la reconstruction du jeu complet, √©tape par √©tape, en suivant les explications d√©taill√©es de chaque fichier markdown et en consultant les codes correspondants. Le jeu complet repose sur 14 fichiers .html, regroup√©s en 8 cat√©gories principales en fonction du type de mini-jeu auquel ils appartiennent :

### Pour tester le jeu au complet, vous pouvez utiliser l'URL suivant : 

https://stellular-seahorse-46e01a.netlify.app/index.html

### Si vous voulez observer chaque mini-jeu ind√©pendamment, 
### cliquez sur les liens suivants qui redirigent vers un d√©p√¥t GitHub d√©di√© au mini-jeu contenant √† la fois un fichier .md explicatif du code et de la fa√ßon dont le code a √©t√© construit et le(s) fichier(s) .html (le code utilis√©) : 

#### Quizz interactif sous la forme de QCM
- [Lien vers le r√©po Git pour le quizz interactif QCM](https://github.com/JosephGrob/MINI-JEU1-Quizz-Interactif-QCM)

#### Questions-R√©ponses interactives √† relier
- [Lien vers le r√©po Git pour les questions-r√©ponses interactives](https://github.com/JosephGrob/MINI-JEU2-Questions-Reponses-Relier)

#### Labyrinthe interactif
- [Lien vers le r√©po Git pour le labyrinthe interactif](https://github.com/JosephGrob/MINI-JEU3-Labyrinthe-Interactif)

#### Ligne temporelle interactive 
- [Lien vers le r√©po Git pour la ligne temporelle interactive](https://github.com/JosephGrob/MINI-JEU4-Ligne-Temporelle-Jeu)

#### Puzzle interactif statique (sans mouvement des pi√®ces)
- [Lien vers le r√©po Git pour le puzzle statique interactif](https://github.com/JosephGrob/MINI-JEU5-Puzzle-Statique-Interactif)

#### Puzzle interactif par mouvement des pi√®ces
- [Lien vers le r√©po Git pour le puzzle interactif dynamique](https://github.com/JosephGrob/MINI-JEU6-Puzzle-Dynamique)

#### Jeu de m√©moire interactif
- [Lien vers le r√©po Git pour le jeu de m√©moire interactif](https://github.com/JosephGrob/MINI-JEU7-Memory-Interactif)

#### Jeu de parcours interactif
- [Lien vers le r√©po Git pour le jeu de parcours interactif](https://github.com/JosephGrob/MINI-JEU8-Parcours-Questions)


---

# 1. Explications Techniques : R√©alisation et Fonctionnement de `index.html`

## Introduction de "Index.html" : Fonctionnement global des mini-jeux

Le fichier `index.html` constitue le c≈ìur de l'exp√©rience de jeu, reliant tous les mini-jeux interactifs autour du th√®me de la R√©forme genevoise. √Ä travers une carte interactive bas√©e sur **Leaflet.js**, l'utilisateur peut explorer divers lieux historiques de Gen√®ve, chacun associ√© √† un mini-jeu. Une fois les mini-jeux r√©solus, l'utilisateur d√©bloque des lettres qui composent l'adresse d'un lieu secret, maintenant son engagement tout en favorisant l'apprentissage.

La structure et les fonctionnalit√©s de `index.html` sont con√ßues pour :

1. Offrir une navigation intuitive via une carte interactive.
2. G√©rer les connexions entre les mini-jeux et les lettres d√©bloqu√©es.
3. Suivre les progr√®s des utilisateurs avec des indicateurs visuels.
4. Pr√©senter un mot myst√®re final, r√©v√©lant l'adresse du lieu secret.

---

## Fonctionnalit√©s principales et sections du code "index.html"

### 1. Initialisation de la carte interactive

La carte interactive est le point central de `index.html`. Elle est cr√©√©e avec la biblioth√®que **Leaflet.js** et affiche des marqueurs repr√©sentant les lieux historiques. Chaque marqueur est ensuite associ√© √† un mini-jeu.

#### Fonctionnalit√©s principales
- Centrage initial sur Gen√®ve et sa vieille ville, le coeur de la R√©forme protestante.
- Affichage des marqueurs pour chaque lieu, avec des ic√¥nes personnalis√©es, gr√¢ce √† leurs URL.
- Association de chaque marqueur √† un mini-jeu via un lien.

#### codes utilis√©s : 

1. Affichage du fond de carte gr√¢ce √† la biblioth√®que **Leaflet.js**:
<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript
    var map = L.map('map', {
        zoomControl: true, // Ajout des contr√¥les de zoom
        maxZoom: 18,       // Niveau de zoom maximum
        minZoom: 10        // Niveau de zoom minimum
    }).setView([46.201959880626424, 6.14730078708044], 17); // Centrage initial sur Gen√®ve

    // Ajout d'un calque de tuiles pour afficher les cartes
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
        attribution: '¬© CARTO' // Cr√©dits pour le fournisseur de tuiles
    }).addTo(map);

    </div>
```
</div>

2.  Ajouter les marqueurs √† la carte (les lieux de la R√©forme ici), ajout des popups pour chaque marqueur avec le lien vers le mini-jeu et recentrage de la carte apr√®s fermeture des popups:

<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript
    function addMarkers(waypoints) {
                // Cr√©ation d'un marqueur pour un waypoint sp√©cifique et ajout √† la carte
                var marker = L.marker(waypoint.coordinates, { icon: icon }).addTo(map);

                // D√©terminer le lien vers le mini-jeu pour chaque waypoint
                var miniJeuUrl;
                switch (waypoint.name) {
                    case "Le site arch√©ologique de la Cath√©drale Saint-Pierre":
                        miniJeuUrl = 'quizz.html';
                        break;
                    case "La Tour du Molard":
                        miniJeuUrl = 'Sortie_puzzle.html';
                        break;
                    case "La Maison Tavel":
                        miniJeuUrl = 'Europe_Calvin.html';  
                        break;
                    ...
                        
                }

                // Contenu du popup incluant le nom et un lien vers le mini-jeu
                var popupContent = `
                    <div>
                        <strong>${waypoint.name}</strong><br>
                        <a href="${miniJeuUrl}" target="_self">Acc√®s au mini-jeu</a>
                    </div>
                `;

                // Associe le popup au marqueur
                marker.bindPopup(popupContent);

                // G√®re l'ouverture du popup lorsque l'utilisateur clique sur le marqueur
                marker.on('click', function() {
                    marker.openPopup();
                });

                // Fonction pour recentrer la carte apr√®s la fermeture d'un popup
                map.on('popupclose', function () {
                    // Recentrer la carte sur la position initiale 
                    map.setView([46.201959880626424, 6.14730078708044], 17);
                });
            };

    </div>
```
</div>

3. Les lieux historiques (nos icones) et leurs informations (coordonn√©es, URL des ic√¥nes, etc.) sont d√©finis dans un tableau de donn√©es:

<div style="border: 1px solid #ddd; padding: 10px;margin: 10px 0;"> 

```javascript
        // Donn√©es des marqueurs avec des ic√¥nes personnalis√©es
        var waypoints = [
            { name: "La fontaine de l'Escalade", coordinates: [46.20374005005952, 6.14376619916994], iconUrl: 'https://cdn-icons-png.flaticon.com/512/382/382316.png' },
            { name: "Le Mus√©e Tatiana Zoubov", coordinates: [46.20169750116412, 6.1445213669340175], iconUrl: 'https://cdn-icons-png.flaticon.com/512/3936/3936764.png' },
            { name: "Le Monument international de la R√©formation", coordinates: [46.20021323907556, 6.145877866790115], iconUrl: 'https://cdn-icons-png.flaticon.com/128/5985/5985359.png' },
            { name: "H√¥tel de Ville", coordinates: [46.20082826849649, 6.14685899892906], iconUrl: 'https://cdn-icons-png.flaticon.com/512/4797/4797110.png' },
            { name: "L'Ancien Arsenal", coordinates: [46.20118262528934, 6.1470305989292005], iconUrl: 'https://cdn-icons-png.flaticon.com/512/2144/2144733.png' },
            { name: "La Maison Tavel", coordinates: [46.201439880626424, 6.14730078708044], iconUrl: 'https://cdn-icons-png.flaticon.com/512/3936/3936764.png' },
            { name: "La Place du Bourg-de-Four", coordinates: [46.20009574069345, 6.1490588877031715], iconUrl: 'https://cdn-icons-png.flaticon.com/512/9732/9732185.png' },
            { name: "Le Mus√©e international de la R√©forme", coordinates: [46.20142631586874, 6.148557910985599], iconUrl: 'https://cdn-icons-png.flaticon.com/512/3936/3936764.png' },
            { name: "La Cath√©drale Saint-Pierre", coordinates: [46.20123740229765, 6.1482750374787365], iconUrl: 'https://cdn-icons-png.flaticon.com/512/4313/4313544.png' },
            { name: "Le site arch√©ologique de la Cath√©drale Saint-Pierre", coordinates: [46.201085840345335, 6.147888138975222], iconUrl: 'https://cdn-icons-png.flaticon.com/512/3936/3936764.png' },
            { name: "Auditoire de Calvin", coordinates: [46.20085503585228, 6.148318004371298], iconUrl: 'https://cdn-icons-png.flaticon.com/512/9061/9061938.png' },
            { name: "Le Coll√®ge Calvin", coordinates: [46.2008686039396, 6.151007748107211], iconUrl: 'https://cdn-icons-png.freepik.com/512/4729/4729436.png' },
            { name: "Eglise Evang√©lique luth√©rienne de Gen√®ve", coordinates: [46.20097696309722, 6.149556623691599], iconUrl: 'https://cdn-icons-png.flaticon.com/512/9061/9061938.png' },
            { name: "La Tour du Molard", coordinates: [46.20387914429126, 6.148108876482555], iconUrl: 'https://cdn-icons-png.flaticon.com/256/993/993612.png' },
        ];

    </div>

```
</div>

### 2. Gestion des mini-jeux et progression

Chaque mini-jeu est associ√© √† une cl√© dans `localStorage` pour suivre son √©tat de compl√©tion. Lorsqu'un mini-jeu est termin√©, une lettre est d√©bloqu√©e et une ic√¥ne "OK" s'affiche sur le marqueur correspondant. Une fois tous les mini-jeux compl√©t√©s, le joueur d√©couvre un lieu secret.

#### Fonctionnalit√©s principales
- **Suivi de progression** : Gestion des √©tats de compl√©tion des mini-jeux √† l'aide de `localStorage`.
- **D√©blocage des lettres** : Lorsqu'un mini-jeu est termin√©, une lettre est ajout√©e √† une position sp√©cifique pour former l'adresse du lieu secret.
- **R√©v√©lation du lieu secret** : Une fois tous les mini-jeux compl√©t√©s, un marqueur sp√©cial appara√Æt sur la carte, r√©v√©lant le lieu final.

#### Codes utilis√©s

1. Suivi de la progression: 
   Le script v√©rifie constamment si tous les mini-jeux ont √©t√© compl√©t√©s gr√¢ce √† un √©couteur d'√©v√©nements sur `storage` et une v√©rification des cl√©s dans `localStorage`.

<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript
   document.addEventListener('DOMContentLoaded', function() {
       checkAllGamesCompleted(); // V√©rifie au chargement de la page si tous les jeux sont compl√©t√©s
       window.addEventListener('storage', function() {
           checkAllGamesCompleted(); // V√©rifie dynamiquement si un jeu est termin√©
       });
   });

   function checkAllGamesCompleted() {
       const games = [
           'puzzleCompleted',
           'quizCompleted',
           'labyrintheCompleted',
           'reformationGameCompleted',
           'reformationMuseumCompleted',
           'cathedralePuzzleCompleted',
           'europeCalvinCompleted',
           'escaladeGameCompleted',
           'auditoireGameCompleted',
           'bourgDeFourGameCompleted',
           'lutherianQuizCompleted',
           'hotelDeVilleQuizCompleted',
           'collegeCalvinCompleted',
           'tatianaZoubovPuzzleCompleted'
       ];

       // V√©rifie si toutes les cl√©s indiquent que les jeux sont termin√©s
       const allCompleted = games.every(game => localStorage.getItem(game) === 'true');

       if (allCompleted) {
           afficherLieuSecret(); // Affiche le lieu secret si tous les jeux sont termin√©s
       }
   }

   </div>
```
</div>

2. D√©blocage des lettres: 
    Affichage des lettres d√©bloqu√©es lorsqu'un mini-jeu est termin√© (via le localStorage), une lettre est plac√©e √† une position sp√©cifique pour former l'adresse secr√®te: 

<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript
        // √âv√©nement d√©clench√© au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            loadAllLetters(); // Charge les lettres
            checkAllGamesCompleted(); // V√©rifie si tous les jeux sont termin√©s
            // V√©rifiez si chaque mini-jeu a √©t√© compl√©t√© et placez les lettres correspondantes √† la bonne position
            const puzzleCompleted = localStorage.getItem('puzzleCompleted');
            if (puzzleCompleted === 'true') {
                placeLetterAtPosition(2, 'E');
            }

            const quizCompleted = localStorage.getItem('quizCompleted');
            if (quizCompleted === 'true') {
                placeLetterAtPosition(3, 'D');
            }

            const labyrintheCompleted = localStorage.getItem('labyrintheCompleted');
            if (labyrintheCompleted === 'true') {
                placeLetterAtPosition(1, 'U');
            }

            ... 

            </div>

        <div style="border: 1px solid #ddd; padding: 10px; background-color: #f9f9f9; margin: 10px 0;">
        // Place une lettre √† une position donn√©e dans l'affichage
        function placeLetterAtPosition(position, letter) {
            const letterDisplay = document.getElementById(`letter-display-${position}`);
            if (letterDisplay) {
                letterDisplay.textContent = letter;
            } else {
                console.error(`Le conteneur de la lettre √† la position ${position} est introuvable.`);
            }
        }

        </div>
```
</div>

3. Clignotement des lettres d√©bloqu√©es:
    Pour rendre l'apparition des lettres plus dynamique et captivante, un effet de clignotement a √©t√© ajout√©. Cet effet est d√©clench√© lorsqu'une lettre d√©bloqu√©e entre en contact avec un carr√© transparent plac√© au-dessus de sa ligne correspondante. Cela permet de renforcer visuellement la progression de l'utilisateur:

<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript
        // V√©rifie en permanence les chevauchements entre les lettres et les carr√©s transparents
        function detectOverlap() {
            for (let i = 0; i < 14; i++) {
                const letterDisplay = document.getElementById(`letter-display-${i}`);
                const squareElement = document.getElementById(`transparent-square-${i}`);

                if (!letterDisplay || !squareElement) continue;

                // R√©cup√®re les positions des √©l√©ments dans la fen√™tre
                const letterRect = letterDisplay.getBoundingClientRect();
                const squareRect = squareElement.getBoundingClientRect();

                // V√©rifie si les deux √©l√©ments se chevauchent
                if (
                    letterRect.left < squareRect.right &&
                    letterRect.right > squareRect.left &&
                    letterRect.top < squareRect.bottom &&
                    letterRect.bottom > squareRect.top
                ) {
                    triggerBlinkAndHide(letterDisplay, squareElement, i);
                }
            }
        }

        </div>

        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">
        // Ajoute un effet visuel (clignotement) et masque le carr√© apr√®s chevauchement
        function triggerBlinkAndHide(letterDisplay, squareElement, index) {
            if (letterDisplay) {
                letterDisplay.classList.add('blink');
                if (squareElement) {
                    squareElement.style.display = 'none';
                    localStorage.setItem(`square-${index}`, 'hidden');
                }
                setTimeout(() => {
                    letterDisplay.classList.remove('blink');
                }, 3000);

                console.log(`Carr√© ${index} supprim√© et lettre clignotante.`);
            }
        }

        </div>

        <div style="border: 1px solid #ddd; padding: 10px; background-color: #f9f9f9; margin: 10px 0;">
        // V√©rifie les chevauchements toutes les 100ms
        setInterval(detectOverlap, 100); 

        // Charge toutes les lettres sauvegard√©es depuis localStorage
        function loadAllLetters() {
            const linesContainer = document.getElementById('lines-container');

            for (let i = 0; i < 14; i++) {
                const letter = localStorage.getItem(`letter-${i}`);
                if (letter) {
                    const letterDisplay = document.getElementById(`letter-display-${i}`);
                    if (letterDisplay) {
                        letterDisplay.textContent = letter; 
                    }
                }
            }
        }

        </div>
```
</div>

4. A chaque fois qu'un mini-jeu est compl√©t√©, un "OK" apparait sur l'icone en question. Ceci permet une meilleur exp√©rience utilisatrice, permettant ainsi d'indiquer √† l'utilisateur quels mini-jeu sont compl√©t√©s et ceux qu'il doit encore effectuer. Nous utilisons encore le "localStorage" pour avoir le suivi des jeux compl√©t√©s: 

<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript
        // Fonction pour cr√©er une nouvelle ic√¥ne "OK" avec l'ic√¥ne d'origine l√©g√®rement transparente pour montrer qu'un mini-jeu est termin√©
        function createOkIcon(waypoint) {
            return L.divIcon({
                html: `
                    <div style="position: relative; width: 40px; height: 40px;">
                        <!-- Ic√¥ne d'origine, l√©g√®rement transparente -->
                        <img src="${waypoint.iconUrl}" style="width: 100%; height: 100%; opacity: 0.5;">
                        <!-- Texte "OK" par-dessus -->
                        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: green; font-weight: bold; font-size: 20px;">
                            OK
                        </div>
                    </div>
                `,
                className: 'custom-ok-icon',
                iconSize: [80, 80],  
                iconAnchor: [20, 20] 
            });
        }

        </div>

        <div style="border: 1px solid #ddd; padding: 10px; background-color: #f9f9f9; margin: 10px 0;">
        // Fonction pour ajouter des marqueurs sur la carte
        function addMarkers(waypoints) {
            waypoints.forEach(function(waypoint) {
                let icon;

                // V√©rifiez si le mini-jeu de la Tour du Molard est termin√© et placer le "OK" sur l'icone
                if (waypoint.name === "La Tour du Molard" && localStorage.getItem('puzzleCompleted') === 'true') {
                    icon = createOkIcon(waypoint); // Ic√¥ne OK pour la Tour du Molard
                } 
                // V√©rifiez si le mini-jeu de la Maison Tavel est termin√© et placer le "OK" sur l'icone
                else if (waypoint.name === "La Maison Tavel" && localStorage.getItem('europeCalvinCompleted') === 'true') {
                    icon = createOkIcon(waypoint); // Ic√¥ne OK pour la Maison Tavel
                } 

                ...

        </div>
```
</div>


5. R√©v√©lation du lieu secret
    Une fois que tous les jeux ont √©t√© compl√©t√©s et que toutes les lettres ont √©t√© correctement plac√©es, le lieu secret apparait sur la carte. Pour se faire, nous cr√©ons un nouveau marqueur qui apparait uniquement lorsque tous les jeux ont √©t√© compl√©t√©s (via le LocalStorage). Ce marqueur apparait ainsi sur la carte et nous ouvrons automatiquement le popup correspondant au marqueur pour que l'utilisateur puisse prendre connaissance de sa r√©compense. 

<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript        
        // Affiche un marqueur pour le lieu secret une fois tous les mini-jeux compl√©t√©s
        function afficherLieuSecret() {
            const icon = L.divIcon({
                html: `
                    <div style="position: relative; width: 60px; height: 60px; animation: blink 2s 3;">
                        <img src="${lieuSecretIconUrl}" style="width: 100%; height: 100%; border-radius: 50%;">
                    </div>
                `,
                className: '',
                iconSize: [60, 60], 
                iconAnchor: [30, 30], 
            });

            const marker = L.marker(lieuSecretCoordinates, { icon: icon }).addTo(map);

            // Contenu du popup affichant le message final
            const popupContent = `
                <div style="font-family: Arial, sans-serif; text-align: center; display: flex; align-items: center; gap: 15px; padding: 10px;">
                    <!-- Image -->
                    <div style="flex: 1; text-align: center;">
                        <img src="https://www.delcampe.net/static/img_large/auction/000/928/607/614_001.jpg" 
                            alt="Passage Secret du Monetier" 
                            style="max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 8px; max-height: 150px;">
                    </div>
                    <!-- Texte -->
                    <div style="flex: 2; text-align: left;">
                        <h2 style="color: #2d2d86; font-size: 18px; margin-bottom: 10px;">üéâ Bravo !</h2>
                        <p style="font-size: 14px; line-height: 1.6; color: #333;">
                            Vous avez d√©couvert le passage secret tr√®s √©troit de <strong>Monetier</strong>, utilis√© par les Genevois pour d√©fendre la ville durant la R√©forme et durant l'Escalade. Vous pouvez aller le d√©couvrir !
                        </p>
                        <p style="font-size: 14px; color: #2d2d86; font-weight: bold; margin-top: 10px;">
                            Cliquez sur "Recommencer le jeu" pour les prochains utilisateurs!
                        </p>
                    </div>
                </div>
            `;

            marker.bindPopup(popupContent, {
                maxWidth: 600, 
                minWidth: 200, 
            });
            marker.openPopup(); 
        }

        </div>

        <div style="border: 1px solid #ddd; padding: 10px; background-color: #f9f9f9; margin: 10px 0;">
        // Ajoute un observateur pour d√©tecter les changements dans localStorage (au cas o√π les jeux seraient compl√©t√©s dynamiquement)
        document.addEventListener('DOMContentLoaded', function() {
            checkAllGamesCompleted();
            window.addEventListener('storage', function() {
                checkAllGamesCompleted();
            });
        });

        </div>
```
</div>

## 3. Optimisation de l'exp√©rience utilisateur

Pour garantir une navigation fluide et intuitive, des √©l√©ments ont √©t√© ajout√©s pour am√©liorer le confort et la convivialit√© de l'interface. Cela inclut la gestion de l'inactivit√© avec un **overlay de rappel**, ainsi que des boutons pratiques pour recentrer la carte ou recommencer le jeu. Ces fonctionnalit√©s permettent de maintenir l'engagement de l'utilisateur tout en lui offrant des options claires pour interagir avec le jeu.

### 3.1 Gestion de l'inactivit√© avec un overlay

Un syst√®me de d√©tection d'inactivit√© a √©t√© impl√©ment√© pour √©viter que la session reste inutilis√©e trop longtemps. Lorsqu'aucune interaction n'est d√©tect√©e, un **overlay** s'affiche pour notifier l'utilisateur et lui offre un bouton pour prolonger la session. Si aucune action n'est prise, le jeu est automatiquement r√©initialis√© et un nouvel utilisateur peut commencer le jeu sans √™tre "spoil√©" par l'avancement du l'utilisateur pr√©c√©dent. 

#### Code utilis√© :

1. Affichage de l'overlay et d√©marrage du compte √† rebours :

<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript
            // Fonction pour afficher l'overlay et d√©marrer le compte √† rebours
        function showInactivityOverlay() {
            const overlay = document.getElementById('inactivityOverlay');
            const countdownTimer = document.getElementById('countdownTimer');
            let countdown = 60;

            overlay.style.display = 'flex'; // Afficher l'overlay
            countdownTimer.textContent = countdown;

            // D√©marrer le compte √† rebours
            countdownInterval = setInterval(() => {
                countdown--;
                countdownTimer.textContent = countdown;

                if (countdown === 0) {
                    clearInterval(countdownInterval);
                    resetGame(); 
                }
            }, 1000);

            // Planifier la r√©initialisation apr√®s 30 secondes si "Continuer le jeu en cours" n'est pas cliqu√©
            resetTimeout = setTimeout(() => {
                overlay.style.display = 'none'; 
                resetGame();
            }, 30000);
        }

    </div>
```
```javascript
        <div style="border: 1px solid #ddd; padding: 10px; background-color: #f9f9f9; margin: 10px 0;">

        // Fonction pour masquer l'overlay et annuler la r√©initialisation si l'utilisateur clique sur "Continuer le jeu en cours"
        function cancelReset() {
            const overlay = document.getElementById('inactivityOverlay');
            overlay.style.display = 'none'; 
            clearTimeout(resetTimeout); 
            clearInterval(countdownInterval); 
            resetOnInactivity(); 
        }

        // R√©initialisation si l'utilisateur reste inactif (sans interaction ou clic sur "Continuer")
        function resetOnInactivity(timeout = 30000) { 
            clearTimeout(inactivityTimeout); 

            inactivityTimeout = setTimeout(() => {
                showInactivityOverlay(); 
            }, timeout);
        }

        // Ajout d'√©v√©nements uniquement pour surveiller le clic sur "Continuer"
        document.addEventListener('DOMContentLoaded', () => {
            resetOnInactivity(); 

            // G√©rer le clic sur le bouton "Continuer"
            document.getElementById('continueButton').addEventListener('click', cancelReset);
        });

        </div>
```
</div>

2. R√©initialisation automatique en cas d'inactivit√© :

<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript
    function resetOnInactivity(timeout = 30000) { 
        clearTimeout(inactivityTimeout); 

        inactivityTimeout = setTimeout(() => {
            showInactivityOverlay(); 
        }, timeout);
    }

    </div>

    <div style="border: 1px solid #ddd; padding: 10px; background-color: #f9f9f9; margin: 10px 0;">
    document.addEventListener('DOMContentLoaded', () => {
        resetOnInactivity(); 

        // G√©rer le clic sur le bouton "Continuer"
        document.getElementById('continueButton').addEventListener('click', cancelReset);
    });
    </div>
```
</div>

3. Annulation de la r√©initialisation lorsque l'utilisateur reprend la session :

<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

```javascript
    function cancelReset() {
        const overlay = document.getElementById('inactivityOverlay');
        overlay.style.display = 'none'; 
        clearTimeout(resetTimeout); 
        clearInterval(countdownInterval); 
        resetOnInactivity(); 
    }
    </div>
```
</div>

---

### 3.2 Bouton pour recentrer la carte

Un bouton d√©di√© permet de recentrer la carte sur les coordonn√©es initiales (la Maison Tavel) pour faciliter l'exploration en cas de d√©sorientation.

#### Code utilis√© :
<div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">

    ```javascript
    function centerMap() {
        map.setView([46.201959880626424, 6.14730078708044], 17); // Recentre sur Gen√®ve
        }

</div>

</div>
```
### 3.3 Bouton pour recommencer le jeu 

Un Bouton d√©di√© permet de recommencer le jeu. Ceci est particuli√®rement utile pour permettre √† l'utilisateur, soit de r√©-initialiser le jeu √† la fin pour le prochain utilisateur, soit de recommencer volontairement le jeu durant sa partie. Pour faire ceci, nous r√©-initialisons le localStorage gr√¢ce √† la fonction suivante. 

#### Code utilis√© : 

    ```javascript
    function resetGame() {
        // Supprime toutes les entr√©es li√©es aux mini-jeux
        localStorage.clear();

        // Recharge la page pour r√©initialiser l'interface
        location.reload();
    }

    </div>



